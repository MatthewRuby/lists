<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Essay {% block title %}{% endblock %}</title>
  <link rel="stylesheet" type="text/css" href="stylesheets/lib/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="stylesheets/style.css">
<!--   // <script data-main="javascripts/main" src="javascripts/lib/require.js"></script> -->
	<script type="text/javascript" src="javascripts/lib/jquery.js"></script>
	<script type="text/javascript" src="javascripts/lib/underscore-min.js"></script>
	<script type="text/javascript" src="javascripts/lib/backbone-min.js"></script>
</head>
<body>
<div id="wrap">
	{% block content %}{% endblock %}
</div>

<script type="text/template" id="section_template">

	<h1 class="headline" contenteditable>Headline</h1>
	<div class="image" contenteditable>Image</div>
	<p class="description" contenteditable>Decription</p>

</script>

<script type="text/javascript">

	var main = document.getElementById('main');

    SectionView = Backbone.View.extend({
        initialize: function(){
            this.render();
        },
        render: function(){
            var template = _.template( $("#section_template").html(), {} );
            $(this.el).html( template );
        },
        events: {
        	"focus .headline, .image, .description" : "startText",
        	"blur .headline, .description" : "blurText",
            "blur .image" : "displayImage"
        },
        startText: function(e){
        	e.target.innerHTML = '';
        },
       	blurText: function(e){
       		if( e.target.innerText === '' ) {
       			e.target.innerText = $(e.target).attr('class');
       		}
        },
        displayImage: function(e){
            console.log(this);
            e.target.innerHTML = '<img src="' + e.target.innerText + '">';
        }
    });

    Button = Backbone.View.extend({
    	el: $('#new'),
    	events: {
            "click" : "newSection"
        },
        newSection: function(){
        	var sect = document.createElement('section');
        	var section_view = new SectionView({ el: sect });
        	main.appendChild(sect)
        }
    });
    var button = new Button({ el : $("#new") })
    
   
</script>

</body>
</html>